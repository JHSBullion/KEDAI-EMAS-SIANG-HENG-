<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KEDAI EMAS SIANG HENG · 会员系统</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- 顶栏 -->
  <div class="navbar">
    <div class="navbar-inner container">
      <div class="brand">
        <span class="crest"></span>
        <span data-i18n="brand_title">KEDAI EMAS SIANG HENG 会员系统</span>
      </div>
      <div class="actions">
        <a class="btn" href="index.html" data-i18n="back_home">返回首页</a>
        <a class="btn" href="login.html" data-i18n="btn_admin">后台</a>
        <div class="lang-pill">
          <!-- ✅ 统一语言选择 -->
          <select class="lang" id="langSwitch">
            <option value="zh">中</option>
            <option value="en">EN</option>
            <option value="ms">BM</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- 内容：二维码展示 -->
  <section class="hero">
    <div class="container">
      <div class="wrap">
        <div class="card" style="max-width:680px;margin:0 auto;text-align:center">
          <h1 class="h1" data-i18n="member_portal">会员门户</h1>
          <p class="sub" data-i18n="portal_desc">请扫描下方二维码进入会员系统</p>
          <div style="margin:20px auto">
            <canvas id="qrcanvas"></canvas>
          </div>
          <div style="margin-top:20px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
            <button class="btn" id="regen" data-i18n="btn_regenerate">重置二维码</button>
            <button class="btn" id="print" data-i18n="btn_print">打印</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="footer">© 2025 KEDAI EMAS SIANG HENG · All rights reserved.</div>

  <!-- ✅ 脚本部分 -->
  <script src="qrcode.min.js"></script>
  <script type="module">
    import { initLang, applyLang } from "./lang.js";

    // 初始化语言
    initLang();

    // 监听下拉框切换
    document.getElementById("langSwitch").addEventListener("change", (e)=>{
      applyLang(e.target.value);
    });

    // 生成二维码逻辑
    const canvas = document.getElementById("qrcanvas");
    const regenBtn = document.getElementById("regen");
    const printBtn = document.getElementById("print");

    function makeQR(){
      const url = location.origin + "/index.html";
      QRCode.toCanvas(canvas, url, { width: 260 }, err=>{
        if(err) console.error(err);
      });
    }

    regenBtn.addEventListener("click", makeQR);
    printBtn.addEventListener("click", ()=>{ window.print(); });

    makeQR();
  </script>
</body>
</html>
