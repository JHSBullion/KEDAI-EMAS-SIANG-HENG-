<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>KEDAI EMAS SIANG HENG · Customer Points</title>
<link rel="icon" href="data:,">
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --soft-gold: #cbaF63;
    --platinum: #eaeaea;
    --dark-bg: #0b0c10;
    --card-bg: rgba(20, 20, 25, 0.75);
    --line: rgba(255,255,255,0.12);
  }
  body {
    margin:0; padding:0;
    font-family:'Manrope',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    background: radial-gradient(ellipse at top,#1a1b1f,#0b0c10);
    color: var(--platinum);
    display:flex; justify-content:center; align-items:center;
    min-height:100vh;
  }
  .card {
    width:100%; max-width:640px;
    background: var(--card-bg);
    backdrop-filter: blur(14px);
    border:1px solid var(--line);
    border-radius:20px;
    padding:32px;
    box-shadow:
      0 0 0 1px rgba(203,175,99,.18),
      0 30px 60px rgba(0,0,0,.65);
    text-align:center;
  }
  .brand {
    font-size:16px;
    font-weight:700;
    letter-spacing:1px;
    color:var(--soft-gold);
    margin-bottom:14px;
  }
  h1 {
    font-size:26px;
    margin:0 0 18px;
    font-weight:700;
    background: linear-gradient(90deg,#fff,var(--platinum));
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
  }
  .lang {
    display:flex; justify-content:center; gap:10px;
    margin-bottom:20px;
  }
  .lang button {
    background: transparent;
    border:1px solid var(--line);
    border-radius:18px;
    padding:4px 12px;
    font-size:14px; color: var(--platinum);
    cursor:pointer; transition: all .3s;
  }
  .lang button.active {
    border-color: var(--soft-gold);
    color:#000; background: var(--soft-gold);
  }
  .row {
    display:flex; gap:10px; flex-wrap:wrap;
    margin-bottom:16px;
  }
  input {
    flex:1; min-width:220px;
    height:46px; border-radius:12px;
    border:1px solid var(--line);
    background:rgba(255,255,255,0.08);
    color: var(--platinum);
    padding:0 14px; font-size:16px;
  }
  button.query {
    height:46px; border-radius:12px;
    border:none; cursor:pointer;
    font-size:16px; font-weight:600;
    padding:0 24px;
    background: var(--soft-gold); color:#000;
    transition: all .3s;
  }
  button.query:hover {
    box-shadow:0 0 14px rgba(203,175,99,.7);
  }
  .msg { margin:12px 0; font-size:14px; }
  .err { color:#f87171; }
  .points-box {
    margin-top:20px;
    font-size:20px;
    font-weight:600;
    background:rgba(255,255,255,0.06);
    padding:18px;
    border-radius:14px;
  }
  .points {
    font-size:40px; font-weight:800;
    color: var(--soft-gold);
  }
  .nav {
    margin-top:20px; font-size:14px;
  }
  .nav a {
    color:var(--soft-gold);
    margin:0 10px;
    text-decoration:none;
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SB = supabase.createClient(
 "https://mnzwqqxybhjqrfzydwk.supabase.co",
 "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1uendxcXh5YmhqcXJmcnp5ZHdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY0NzgzMzIsImV4cCI6MjA3MjA1NDMzMn0.Yo27vsFqgVM9wWKRgI-ErV2Fl6kjsYcQQPqbe8nGZOQ"
);
const $=s=>document.querySelector(s);

const i18n = {
  BM:{title:"Semak Mata Ahli",phonePH:"Sila masukkan nombor telefon anda",query:"Semak",hello:"Pelanggan dihormati",points:"Mata Semasa",hint:"Jika maklumat tidak tepat, sila hubungi kaunter.",notfound:"Nombor telefon ini tiada dalam rekod.",fail:"Gagal: "},
  EN:{title:"Member Points Check",phonePH:"Enter your phone number",query:"Check",hello:"Dear Member",points:"Current Points",hint:"If the info seems wrong, please contact the counter.",notfound:"No member found for this phone.",fail:"Failed: "},
  ZH:{title:"会员积分查询",phonePH:"请输入您的电话",query:"查询",hello:"尊敬的会员",points:"当前积分",hint:"如信息不符，请联系柜台。",notfound:"未找到该电话的会员。",fail:"查询失败："}
};
let LANG = localStorage.getItem("lang") || "BM";

function setLang(l){
  LANG=l; localStorage.setItem("lang",l);
  const t=i18n[l];
  $("#title").textContent=t.title;
  $("#phone").placeholder=t.phonePH;
  $("#btn").textContent=t.query;
  document.querySelectorAll(".lang button").forEach(b=>b.classList.remove("active"));
  document.querySelector(`.lang button[data-lang="${l}"]`).classList.add("active");
}

async function query(){
  const phone=$("#phone").value.trim();
  if(!phone) return;
  try{
    const {data,error} = await SB.from("member_points").select("name,phone,points").eq("phone",phone).maybeSingle();
    if(error||!data){
      $("#msg").innerHTML=`<div class="err">${i18n[LANG].notfound}</div>`;
      $("#result").style.display="none";return;
    }
    $("#name").textContent=data.name||"Member";
    $("#pts").textContent=data.points??0;
    $("#result").style.display="";
    $("#msg").innerHTML="";
  }catch(e){
    $("#msg").innerHTML=`<div class="err">${i18n[LANG].fail}${e.message}</div>`;
  }
}

document.addEventListener("DOMContentLoaded",()=>setLang(LANG));
</script>
</head>
<body>
  <div class="card">
    <div class="brand">KEDAI EMAS SIANG HENG</div>
    <h1 id="title">Member Points Check</h1>

    <div class="lang">
      <button data-lang="BM" onclick="setLang('BM')">BM</button>
      <button data-lang="EN" onclick="setLang('EN')">EN</button>
      <button data-lang="ZH" onclick="setLang('ZH')">中文</button>
    </div>

    <div class="row">
      <input id="phone" placeholder="Enter your phone number" />
      <button id="btn" class="query" onclick="query()">Check</button>
    </div>

    <div id="msg" class="msg"></div>

    <div id="result" style="display:none">
      <div><span id="hello"></span> <b id="name"></b></div>
      <div class="points-box">
        <span id="pointsLabel"></span>
        <div class="points"><span id="pts">0</span></div>
      </div>
      <div id="hint" class="hint"></div>
    </div>

    <div class="nav">
      <a href="qr.html">QR</a> | 
      <a href="add-member.html">Admin</a> | 
      <a href="points.html">Admin Points</a>
    </div>
  </div>
</body>
</html>
