<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>会员积分查询 · KEDAI EMAS SIANG HENG</title>
<link rel="icon" href="data:,">
<style>
:root{color-scheme:dark light}
body{margin:0;background:#0b1020;color:#e7e9ee;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto}
.wrap{max-width:960px;margin:56px auto;padding:0 18px}
.card{background:#0f172a;border:1px solid #1f2937;border-radius:16px;padding:20px;box-shadow:0 10px 40px rgba(0,0,0,.35)}
h1{font-size:20px;margin:0 0 14px}
.row{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0}
input,button{height:44px;border-radius:10px;border:1px solid #344155;background:#0b1220;color:#e7e9ee;padding:0 12px}
input{flex:1;min-width:240px}
.primary{background:#2563eb;border-color:#3b82f6;cursor:pointer}
.hint{color:#9aa4b2;font-size:13px}
table{width:100%;border-collapse:collapse;margin-top:14px}
th,td{border-bottom:1px solid #1f2937;padding:10px 8px;text-align:left}
.brand{font-weight:700;color:#f5d58a}
.nav a{color:#93c5fd;margin-right:14px;text-decoration:none}
</style>
<script type="module">
import { api, tip } from './web.js'

async function lookup(){
  const phone = document.querySelector('#phone').value.trim()
  const msg = document.querySelector('#msg')
  if(!phone){ tip(msg,'请输入手机号',false); return }
  try{
    const data = await api('/.netlify/functions/member-points?phone='+encodeURIComponent(phone))
    document.querySelector('#result tbody').innerHTML = `
      <tr><td>${data.member_id}</td><td>${data.name}</td><td>${data.phone}</td><td>${data.points}</td></tr>`
  }catch(e){ tip(msg, '查询失败：'+e.message, false) }
}

window.addEventListener('DOMContentLoaded', ()=>{
  document.querySelector('#btn').addEventListener('click', lookup)
})
</script>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="brand">KEDAI EMAS SIANG HENG</div>
      <h1>会员积分查询</h1>
      <div class="row">
        <input id="phone" placeholder="请输入手机号">
        <button id="btn" class="primary">查询</button>
      </div>
      <div id="msg"></div>

      <table id="result">
        <thead><tr><th>Member ID</th><th>Name</th><th>Phone</th><th>Points</th></tr></thead>
        <tbody></tbody>
      </table>

      <div class="nav" style="margin-top:10px">
        <a href="add-member.html">Admin · 新增会员</a>
        <a href="points.html">Admin · 调整积分</a>
        <a href="members.html">会员搜索列表</a>
        <a href="qr.html">QR</a>
      </div>

      <div class="hint" style="margin-top:12px">
        说明：演示阶段开放匿名查询。正式上线请使用 Auth/Service Role 并细化 RLS。
      </div>
    </div>
  </div>
</body>
</html>
